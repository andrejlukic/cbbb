<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Mini EDA (exploratory data analysis) of an e-commerce customer behavior - /blog</title>	
	<meta name="author" content="Andrej Lukic">
	

	<meta name="description" content="The idea is to play around a little bit with Python/Pandas and perform a basic EDA for an ecommerce store. The focus will be on customer behavior, as I find it is often more fun than the usual business KPIs. What can be seen from a simple order history …">


	<link rel="top" href="#" /><link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="https://andrejlukic.de/theme/css/main.css" type="text/css" />
		

	
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="theme-color" content="#ffffff">

</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	    </div>
	      <nav class="pages">
	      </nav>
		<a href="https://andrejlukic.de" class="title">/blog</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Mini EDA (exploratory data analysis) of an e-commerce customer behavior</h1>
		
<div class="metadata">
  <time datetime="2018-12-10T00:00:00+01:00" pubdate>Mo 10 Dezember 2018</time>
    <address class="vcard author">
      by <a class="url fn" href="https://andrejlukic.de/author/andrej-lukic.html">Andrej Lukic</a>
    </address>
  in <a href="https://andrejlukic.de/category/python.html">python</a>
</div>		
		<p><br />
The idea is to play around a little bit with Python/Pandas and perform a basic EDA for an ecommerce store. The focus will be on customer behavior, as I find it is often more fun than the usual business KPIs. What can be seen from a simple order history, which would be something, that every ecommerce platform has stored. In this case the data was randomly generated.</p>
<p>Examining the first few rows to get a feel:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="c1"># load data for 2018</span>
<span class="n">yr</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datapath</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39;\{}_dt-obf.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">yr</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-001.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Data was already cleared of null/missing values and some unneeded columns were dropped.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-000.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<table>
<thead>
<tr>
<th align="left">Columns</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>date</strong></td>
<td align="left">date and time of the transaction</td>
</tr>
<tr>
<td align="left"><strong>customer</strong></td>
<td align="left">cart value</td>
</tr>
<tr>
<td align="left"><strong>items</strong></td>
<td align="left">number of items</td>
</tr>
<tr>
<td align="left"><strong>price</strong></td>
<td align="left">price of individual item</td>
</tr>
<tr>
<td align="left"><strong>category</strong></td>
<td align="left">category of items</td>
</tr>
<tr>
<td align="left"><strong>pay_method</strong></td>
<td align="left">method of payment</td>
</tr>
<tr>
<td align="left"><strong>customer</strong></td>
<td align="left">customer id</td>
</tr>
<tr>
<td align="left"><strong>domain</strong></td>
<td align="left">domain extracted from customer's email</td>
</tr>
<tr>
<td align="left"><strong>registered</strong></td>
<td align="left">customer registration date</td>
</tr>
</tbody>
</table>
<p>Each product belongs to one of the 10 categories:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-003.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>The domain column has been prepared in advance by mapping customer's email address to one of four categories:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-004.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-002.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>No negative or zero values, majority of cart values fall under 313€. </p>
<h3>First look at product categories</h3>
<p>One of the first things to ask, if we sell diverse products, is which categories are the most popular among customers:</p>
<div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">],</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span>
<span class="n">g</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-005.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>It seems that the watches and clothing are two most important categories in terms of revenue for this store. Let's look at the share that each of the categories brings. I will add two more columns, the share of total revenue and for better clarity, also the cumulative sum of the total revenue share:</p>
<div class="highlight"><pre><span></span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;cshare&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">grouped</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">)]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;chare_cs&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;cshare&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">g</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-006.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>The first two categories together make-up roughly 79% of revenue, and the rest of the 8 categories bring the remaining cca 21% of revenue. As is often the case, the result comes close to the Paretto principle (or 80/20 rule), where cca 80% of effect comes from cca 20% of causes. Now let's see how the orders are distributed among categories:</p>
<div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;csharetx&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">grouped</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">)]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;charetx_cs&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;csharetx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">g</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-007.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>When it comes to counting orders, the story is slightly different and it is the first three categories (clothing, watches and shoes), that roughly comprise 84% of all the orders. Still, clothing and watches remaing on top even when it comes to the number of orders.</p>
<p>It is interesting to play around with different tresholds and see for example, how many categories comprise up to 95% of all the revenue:</p>
<div class="highlight"><pre><span></span><span class="n">treshold</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">g</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;charetx_cs&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">treshold</span><span class="p">]</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-008.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Roughly 94% of all the transactions fall in the first 5 categories.</p>
<p>Visualizing orders grouped by categories is much easier than staring into numbers:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span> 
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> 
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span> 

<span class="n">g2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> 
<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;orders count&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">g2</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">g2</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">)])</span> 
<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;revenue&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">g2</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">g2</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">)])</span> 
<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;average price&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">g2</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">g2</span><span class="p">[(</span><span class="s1">&#39;price&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">)])</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-009.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>*the full code in python is a little bit longer in order to make it look nicer and is available for download at the end of the article</p>
<p>Now we know what product categories bring in most of revenue and what the distribution looks like. Now let's look if sales and time are correlated in if yes, how.</p>
<h3>Time</h3>
<div class="highlight"><pre><span></span><span class="c1"># add relevant time-related columns:</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;dayofweek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="n">gh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>    
<span class="n">gw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;dayofweek&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>    
<span class="n">gm</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calendar</span>

<span class="k">def</span> <span class="nf">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">12</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">)])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;{}h&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;xx-small&#39;</span><span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">)])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;dayofweek&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">)])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">calendar</span><span class="o">.</span><span class="n">day_abbr</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;sales by hour of the day&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gh</span><span class="p">)</span>
<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;sales by day of the week&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gw</span><span class="p">)</span>
<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;sales by month&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">gm</span><span class="p">)</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-010.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Nice patterns in customer behavior can be observed from these visualizations. In terms of hours of the day, sale starts peeking after 11-12am, then gradually slows down towards the evening and eventually pretty much stops after 1am at night. Two of the weekdays, Sunday and Monday, seem to be for some reason unpopular among customers and on which sales slows down. In terms of seasonality, clear differences between months can be observed. December and january are the two strongest months, whereas april and september are two of the weakest. </p>
<h3>Does popularity of different product categories depend on time?</h3>
<p>How much do individual categories differ, when it comes to hours, days or months, in which sales are highest? </p>
<div class="highlight"><pre><span></span><span class="c1"># same thing but this time also grouped by categories</span>
<span class="n">gh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;category&#39;</span><span class="p">,</span><span class="s1">&#39;hour&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">gw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;category&#39;</span><span class="p">,</span><span class="s1">&#39;dayofweek&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;category&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>    
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">data</span><span class="p">[(</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">)])</span>     

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">gh</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gh</span><span class="p">[</span><span class="n">gh</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">c</span><span class="p">])</span>
    <span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;dayofweek&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">gw</span><span class="p">[</span><span class="n">gw</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">c</span><span class="p">])</span>
    <span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">gm</span><span class="p">[</span><span class="n">gm</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">c</span><span class="p">])</span>
</pre></div>


<p>*showing here only relevant lines, actual code is longer to style the plots</p>
<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-011.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>When it comes to hours of the day and days of the week, there isn't much diffence among categories. There are peak hours in the afternoon and then sales stops during the night no matter what kind of product. However, as expected, some categories are highly seasonal, while others aren't that much, as some products will be much more popular in only certain times of the year.</p>
<h3>Comparing top sales hours between categories with a heatmap</h3>
<p>Are there any differences in most popular hours between different categories? Crosstab will automatically compute order frequencies for each hour of day for each of the categories. (Categories are unequal in terms of sales, this is why normalization is applied in order to be able to compare them)</p>
<div class="highlight"><pre><span></span><span class="n">mch</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">])</span>
<span class="c1">#normalize categories so we can compare peak hours of unequal categories </span>
<span class="n">mch</span> <span class="o">=</span> <span class="n">mch</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">fix</span><span class="p">,</span> <span class="n">fiy</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>     

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">add_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;top hours for each category&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mch</span><span class="p">)</span> 
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-012.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Just playing around a bit with the heatmap, I find it a cleaner look, if the number of colours on the heatmap is reduced by grouping frequencies into bins. I am sure there is a more elegant way of achieving this, but I just did this manually:</p>
<div class="highlight"><pre><span></span><span class="c1"># normalize dataset and introduce bins:</span>
<span class="k">def</span> <span class="nf">nri</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">reduce_intervals</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>    
    <span class="n">lf</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">reduce_intervals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">lf</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">reduce_intervals</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">reduce_intervals</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lf</span>

<span class="c1"># choose the number of intervals to display:</span>
<span class="n">intv</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">mch</span> <span class="o">=</span> <span class="n">nri</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]),</span> <span class="n">intv</span><span class="p">)</span>
</pre></div>


<p>Having a smaller number of colors results in a cleaner heatmap and peak hours are easier to distinguish:</p>
<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-013.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>We can do the same for the days of the week and months, it follows the same pattern. A practical thing I find with the crosstab function, is the same ability as with the group by to specify the aggregation function and column. For example, visualuzing an average price of an item for each hour of the day would look like this:</p>
<div class="highlight"><pre><span></span><span class="n">mch</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>


<h3>Can customers' email addresses tell us anything?</h3>
<p>I don't expect much interesting data from email addresses, but let's look at it anyway. Before I started, all the emails were categorized by the domain, to which they belong into four groups:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extract_domain</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span><span class="n">domain</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gmail.com&#39;</span><span class="p">,</span><span class="s1">&#39;yahoo.com&#39;</span><span class="p">,</span><span class="s1">&#39;hotmail.com&#39;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">domain</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.de&#39;</span><span class="p">)):</span>
        <span class="k">return</span> <span class="s1">&#39;local&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;other&#39;</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;domain&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;cart&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">),</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">})</span>
</pre></div>


<p>A few interesting facts nonetheless become obvious:</p>
<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-015.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Most of the customers use gmail and local german domain email addresses, however there are some noticable differences between these groupings:</p>
<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-014.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Customers coming from local de domain purchase on average 14.5% cheaper products than customers coming from gmail.com, one possible reason for this could be purchasing from a personal account vs purchasing from your office account (usually a local domain).</p>
<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-016.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>There is also a difference in their favorite hours between customers coming from local domains and customers coming from the rest:</p>
<div class="highlight"><pre><span></span><span class="c1">#what about email domains vs hours of the day</span>
<span class="n">cutoffhour</span> <span class="o">=</span> <span class="mi">6</span> 

<span class="n">eg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cutoffhour</span><span class="p">:]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">eg</span><span class="p">)</span>
</pre></div>


<p>*like previously only important lines shown, the rest is available for download in my github</p>
<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-017.png" alt="drawing" style="margin-top:20px; width:800px;"/></p>
<p>Interestingly, customers coming from local domains start purchasing slightly earlier and are much less active later in the day (probably work related email addresses).</p>
<h3>Fun with animations</h3>
<p>Since it sounds fun, for the end, I would like to animate the heatmap of sales per hour, making each day of the year a separate frame:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">day</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">d</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">day</span><span class="p">]</span>
    <span class="n">d</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;cart&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;ploty6.gif&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s1">&#39;imagemagick&#39;</span><span class="p">)</span>
</pre></div>


<p><img src="static/2018-12-eda_ecomm/2018-12-10-EDA_ecomm-018.gif" alt="drawing" style="margin-top:20px; width:600px;" loop="infinite"/></p>
<p>Well, not very much added value in this case, but it's nice to see how simple it is.</p>
<h3>Conclusion</h3>
<p>Although this was a super short dive into data analysis, I must say, that coming from the world of web development and relational databases, I am amazed at how simple and efficient python/pandas is when it comes to wrangling, transforming and visualizing data.</p>
<p>That's all!</p>
<p>~                                                        </p>	

	</article>

    <p>
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="" data-lang="en" data-size="large" data-related="">Tweet</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	</p>


		  </div>	
		  
		  <div class="sidebar">

	        <nav>
	          <h2>Categories</h2>
	          <ul>
	              <li ><a href="https://andrejlukic.de/category/dropbox.html">dropbox</a></li>
	              <li class="active"><a href="https://andrejlukic.de/category/python.html">python</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://www.linkedin.com/in/andrej-lukic/">LinkedIn</a><i></i></li>
			    </ul>
			  </aside>


		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 Andrej Lukic - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>	

	</div>
	
	  <script>
		var _gaq=[['_setAccount','UA-130263526-1'],['_trackPageview']];
		(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
		g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
		s.parentNode.insertBefore(g,s)}(document,'script'));
	  </script>

</body>
</html>